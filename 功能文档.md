# 云创AI视觉 - 队列批量生成系统功能文档

## 1. 项目概述
本项目是一个基于 Web 的轻量级 AI 视觉批量生成系统，主要用于调用 Gemini 等多模态大模型 API，实现基于产品图和提示词的批量图片生成任务。系统支持队列管理、并发控制、以及参考图辅助生成等功能。

## 2. 核心功能模块

### 2.1 API 配置管理
- **自定义配置**：支持用户配置 API 端点 (Endpoint)、API 密钥 (Key)、模型名称、图片比例及并发数。
- **安全存储**：基于 Web Crypto API (AES-GCM) 算法加密敏感信息，存储于 localStorage。
- **持久化记录**：任务队列状态支持本地自动持久化，刷新页面后可自动恢复任务列表及生成结果。

### 2.2 图像与任务输入 (全新优化布局)
- **产品图上传**：支持多张拖拽、点击上传。
- **参考图上传 (可选)**：支持单张、批量或**文件夹**上传，便于背景、风格迁移参考。
- **实时悬停预览**：
  - 系统所有缩略图（上传区、任务区、结果区）均支持**鼠标悬停放大预览**。
  - 预览采用全局浮动图层，配合优雅的淡入缩放动画，解决溢出遮挡问题。
- **提示词智能编辑**：
  - **自动补全**：系统会自动在用户输入的提示词末尾补齐 `, 4K高清画质` 保证成片质量。
  - **动态检测**：信息不完备（缺少图片或配置）时提交按钮自动禁用。

### 2.3 智能任务队列系统
- **水平卡片化布局**：任务卡片采用紧凑的水平排版，左侧显示信息，中间显示图片与提示词预览，右侧集中操作。
- **行内实时编辑**：对于“等待中”的任务，用户可以直接点击卡片中的提示词进行二次修改，修改后同样会自动补齐 4K 后缀并保存。
- **任务状态监控**：实时展示“等待中、进行中、已完成、失败”四种状态及总任务统计。

### 2.4 生成与结果处理
- **高性能调度**：支持多任务批次顺序处理，内部根据设定并发数并行请求 API。
- **进度可视化**：实时进度条百分比显示，颗粒度精确到每一张图片的生成。
- **结果导出**：
  - 单张预览及下载。
  - **ZIP 批量打包**：集成 JSZip 库，支持一键将整个批次的成果打包下载。

## 3. 技术特性
- **纯前端架构**：单 HTML 文件（或拆分为 style/script），无后端依赖。
- **Premium 设计美学**：
  - 采用 Outfit 现代字体，深灰色、淡紫色高级色调。
  - 全局微动效反馈（Hover 缩放、状态切换动画）。
  - 所有弹出层均具备自适应边缘遮挡检测。
- **数据流稳定性**：修正了 API 链接拼接空格 Bug，去除了冗余 HTTP 请求头，极大提升 API 调用稳定性。

## 4. 文件结构 (v1.0.1 优化版)
- **index.html**: 系统主入口，包含语义化布局结构。
- **css/style.css**: 核心样式表，应用了响应式和现代 UI 规范。
- **js/script.js**: 核心逻辑脚本，包含加密、队列、API 调度及预览控制。
- **功能文档.md**: 项目功能及技术细节指引。
